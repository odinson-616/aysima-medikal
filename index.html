<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AYSƒ∞MA MEDƒ∞KAL | Profesyonel Saƒülƒ±k √á√∂z√ºmleri</title>
  <style>
    :root { --primary: #0066cc; --secondary: #f39c12; --bordo: #7b1e2b; --light-bg: #f8f9fa; }
    body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #fff; color: #333; }

    /* √úst Duyuru Barƒ± */
    .top-notice { background: var(--bordo); color: white; text-align: center; padding: 8px; font-size: 13px; font-weight: bold; }

    /* Ana Header Alanƒ± */
    header { padding: 20px 5%; display: flex; align-items: center; justify-content: space-between; gap: 20px; border-bottom: 1px solid #eee; }
    .logo { font-size: 24px; font-weight: 800; color: var(--bordo); text-decoration: none; min-width: 150px; }
    
    .search-bar { flex-grow: 1; max-width: 600px; display: flex; position: relative; }
    .search-bar input { width: 100%; padding: 12px 20px; border: 2px solid #ddd; border-radius: 5px 0 0 5px; outline: none; transition: 0.3s; }
    .search-bar input:focus { border-color: var(--bordo); }
    .search-btn { background: var(--bordo); color: white; border: none; padding: 0 25px; border-radius: 0 5px 5px 0; cursor: pointer; }

    .header-icons { display: flex; gap: 20px; align-items: center; }
    .icon-box { text-align: center; cursor: pointer; color: #555; position: relative; text-decoration: none; }
    .icon-box span { display: block; font-size: 11px; margin-top: 3px; }
    .badge { position: absolute; top: -5px; right: 5px; background: var(--secondary); color: white; border-radius: 50%; padding: 2px 6px; font-size: 10px; }

    /* Yatay Kategori Men√ºs√º */
    .nav-menu { background: #fdfdfd; border-bottom: 2px solid #eee; overflow-x: auto; white-space: nowrap; display: flex; justify-content: center; padding: 0 5%; }
    .nav-item { padding: 15px 20px; color: #444; text-decoration: none; font-weight: 600; font-size: 14px; cursor: pointer; transition: 0.2s; border-bottom: 3px solid transparent; }
    .nav-item:hover, .nav-item.active { color: var(--bordo); border-bottom-color: var(--bordo); }

    /* √úr√ºn Alanƒ± */
    .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(230px, 1fr)); gap: 25px; }

    /* √úr√ºn Kartƒ± */
    .product-card { border: 1px solid #eee; border-radius: 8px; transition: 0.3s; padding: 15px; display: flex; flex-direction: column; position: relative; }
    .product-card:hover { box-shadow: 0 10px 20px rgba(0,0,0,0.08); transform: translateY(-3px); }
    .img-wrap { width: 100%; aspect-ratio: 1/1; background: #f9f9f9; border-radius: 5px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; }
    .brand { color: #999; font-size: 11px; text-transform: uppercase; margin-bottom: 5px; }
    .title { font-weight: 600; font-size: 14px; height: 40px; overflow: hidden; margin-bottom: 10px; }
    
    .variant-btns { display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap; }
    .v-btn { border: 1px solid #ddd; padding: 4px 8px; border-radius: 4px; font-size: 12px; cursor: pointer; background: white; }
    .v-btn.active { border-color: var(--bordo); background: #fff5f6; color: var(--bordo); }
    
    .price { font-size: 20px; font-weight: 800; color: var(--bordo); margin-bottom: 15px; }
    .add-btn { background: var(--bordo); color: white; border: none; padding: 10px; border-radius: 5px; font-weight: bold; cursor: pointer; transition: 0.2s; }
    .add-btn:hover { opacity: 0.9; }

    /* Mobil D√ºzenlemeler */
    @media (max-width: 768px) {
      header { flex-direction: column; padding: 15px; }
      .search-bar { order: 3; width: 100%; margin: 10px 0; }
      .nav-menu { justify-content: flex-start; }
      .product-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
      .price { font-size: 17px; }
    }
  </style>
</head>
<body>

  <div class="top-notice">15.000 TL √úZERƒ∞ ALI≈ûVERƒ∞≈ûLERDE √úCRETSƒ∞Z KARGO!</div>

  <header>
    <a href="#" class="logo">AYSƒ∞MA MEDƒ∞KAL</a>
    
    <div class="search-bar">
      <input type="text" id="searchInp" placeholder="Aradƒ±ƒüƒ±nƒ±z √ºr√ºn√º yazƒ±nƒ±z..." onkeyup="handleSearch(this.value)">
      <button class="search-btn">üîç</button>
    </div>

    <div class="header-icons">
      <div class="icon-box">üë§<span>Giri≈ü Yap</span></div>
      <div class="icon-box" onclick="alert('Sepet a√ßƒ±lƒ±yor...')">
        üõí<span class="badge" id="cart-count">0</span>
        <span>Sepetim</span>
      </div>
    </div>
  </header>

  <nav class="nav-menu" id="cat-nav">
    <div class="nav-item active" onclick="location.reload()">T√úM √úR√úNLER</div>
    </nav>

  <div class="container">
    <h2 id="cat-title" style="font-size: 20px; border-left: 5px solid var(--bordo); padding-left: 15px; margin-bottom: 25px;">T√ºm √úr√ºnler</h2>
    <div class="product-grid" id="product-list">Y√ºkleniyor...</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = "https://eqpioawtdwkaeuxpfspt.supabase.co";
    const supabaseKey = "sb_publishable_j1qHO04E6qvGJxoQksdHlA_p89plyCA";
    const _supabase = supabase.createClient(supabaseUrl, supabaseKey);
    let allProducts = [];

    async function start() {
      // Kategorileri √ßek ve yatay men√ºye diz
      const { data: cats } = await _supabase.from("categories").select("*");
      cats?.forEach(c => {
        const item = document.createElement("div");
        item.className = "nav-item";
        item.textContent = c.name.toUpperCase();
        item.onclick = () => {
          document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
          item.classList.add('active');
          load(c.id, c.name);
        };
        document.getElementById("cat-nav").appendChild(item);
      });
      load();
    }

    async function load(catId = null, name = "T√ºm √úr√ºnler") {
      document.getElementById("cat-title").textContent = name;
      let q = _supabase.from("products").select("*, product_variants(*)").eq("is_active", true);
      if(catId) q = q.eq("category_id", catId);
      const { data } = await q;
      allProducts = data || [];
      render(allProducts);
    }

    function render(list) {
      const grid = document.getElementById("product-list");
      grid.innerHTML = "";
      list.forEach(p => {
        const vars = p.product_variants.filter(v => v.is_active);
        const def = vars[0] || {price: 0, variant_value: '-'};
        
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <div class="img-wrap">G√∂rsel</div>
          <div class="brand">Aysima Medikal</div>
          <div class="title">${p.name}</div>
          <div class="variant-btns">
            ${vars.map(v => `<button class="v-btn ${v.id===def.id?'active':''}" onclick="change(this, '${v.price}')">${v.variant_value}</button>`).join('')}
          </div>
          <div class="price">${def.price} TL</div>
          <button class="add-btn">SEPETE EKLE</button>
        `;
        grid.appendChild(card);
      });
    }

    function change(btn, price) {
      const card = btn.closest(".product-card");
      card.querySelectorAll(".v-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      card.querySelector(".price").textContent = price + " TL";
    }

    function handleSearch(val) {
      const filtered = allProducts.filter(p => p.name.toLowerCase().includes(val.toLowerCase()));
      render(filtered);
    }

    start();
  </script>
</body>
</html>
