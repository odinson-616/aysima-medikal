<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="AYSÄ°MA MEDÄ°KAL - Kaliteli SaÄŸlÄ±k ÃœrÃ¼nleri">
<title>AYSÄ°MA MEDÄ°KAL | SaÄŸlÄ±k Marketiniz</title>
<style>
:root {
--bordo: #7b1e2b;
--arka-plan: #f4f6f9;
--border: #e1e4e8;
--success: #27ae60;
--danger: #e74c3c;
--warning: #f39c12;
--text-dark: #2c3e50;
--text-light: #7f8c8d;
}
* { box-sizing: border-box; }
html, body { margin: 0; padding: 0; }
body {
font-family: 'Segoe UI', Tahoma, Geneva, sans-serif;
background-color: var(--arka-plan);
overflow-x: hidden;
color: var(--text-dark);
}
/* ===== HEADER ===== */
header {
background: #fff;
padding: 12px 5%;
display: flex;
align-items: center;
justify-content: space-between;
border-bottom: 2px solid var(--border);
position: sticky;
top: 0;
z-index: 1000;
box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.header-left {
display: flex;
align-items: center;
gap: 12px;
text-decoration: none;
min-width: 200px;
cursor: pointer;
}
.header-left img { height: 50px; width: auto; object-fit: contain; }
.brand-name {
font-size: 20px;
font-weight: 800;
color: var(--bordo);
letter-spacing: -0.5px;
}
.search-box {
flex-grow: 1;
max-width: 450px;
margin: 0 30px;
display: flex;
}
.search-box input {
width: 100%;
padding: 10px 15px;
border: 1px solid var(--border);
border-radius: 4px 0 0 4px;
outline: none;
background: #f9f9f9;
font-size: 14px;
transition: border-color 0.2s;
}
.search-box input:focus {
border-color: var(--bordo);
background: white;
}
.search-box button {
background: var(--bordo);
color: white;
border: none;
padding: 0 20px;
border-radius: 0 4px 4px 0;
cursor: pointer;
font-weight: bold;
transition: opacity 0.2s;
}
.search-box button:hover { opacity: 0.9; }
.header-right {
display: flex;
align-items: center;
gap: 15px;
min-width: 350px;
justify-content: flex-end;
}
/* User Menu */
.user-menu { position: relative; }
.user-btn {
background: transparent;
border: 2px solid var(--bordo);
color: var(--bordo);
padding: 8px 16px;
border-radius: 20px;
cursor: pointer;
font-weight: 600;
font-size: 14px;
transition: all 0.2s;
display: flex;
align-items: center;
gap: 8px;
}
.user-btn:hover {
background: var(--bordo);
color: white;
}
.user-dropdown {
position: absolute;
top: 100%;
right: 0;
background: white;
border: 1px solid var(--border);
border-radius: 8px;
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
min-width: 200px;
margin-top: 10px;
display: none;
z-index: 2000;
}
.user-dropdown.active { display: block; }
.user-dropdown a,
.user-dropdown button {
display: block;
width: 100%;
padding: 12px 16px;
border: none;
background: none;
text-align: left;
cursor: pointer;
font-size: 14px;
color: var(--text-dark);
transition: background 0.2s;
text-decoration: none;
}
.user-dropdown a:hover,
.user-dropdown button:hover {
background: var(--arka-plan);
}
.user-dropdown button.logout {
color: var(--danger);
border-top: 1px solid var(--border);
}
/* Cart Button */
.cart-btn {
background: var(--bordo);
color: white;
padding: 8px 16px;
border-radius: 20px;
cursor: pointer;
display: flex;
align-items: center;
gap: 8px;
font-weight: 600;
font-size: 14px;
transition: all 0.2s;
border: 2px solid var(--bordo);
position: relative;
}
.cart-btn:hover {
background: transparent;
color: var(--bordo);
}
#cart-count {
background: var(--danger);
color: white;
border-radius: 50%;
width: 20px;
height: 20px;
display: flex;
align-items: center;
justify-content: center;
font-size: 12px;
font-weight: bold;
}
/* ===== AUTH MODAL ===== */
#auth-modal {
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
background: white;
padding: 40px;
border-radius: 12px;
z-index: 3000;
width: 90%;
max-width: 420px;
box-shadow: 0 10px 40px rgba(0,0,0,0.2);
display: none;
animation: slideIn 0.3s ease;
}
#auth-modal.active { display: block; }
@keyframes slideIn {
from {
opacity: 0;
transform: translate(-50%, -55%);
}
to {
opacity: 1;
transform: translate(-50%, -50%);
}
}
.auth-close {
position: absolute;
top: 15px;
right: 15px;
background: none;
border: none;
font-size: 28px;
cursor: pointer;
color: #999;
transition: color 0.2s;
}
.auth-close:hover { color: var(--text-dark); }
.auth-tabs {
display: flex;
gap: 10px;
margin-bottom: 25px;
border-bottom: 2px solid var(--border);
}
.auth-tab {
flex: 1;
padding: 12px;
background: none;
border: none;
cursor: pointer;
font-weight: 600;
color: var(--text-light);
border-bottom: 3px solid transparent;
transition: all 0.2s;
}
.auth-tab.active {
color: var(--bordo);
border-bottom-color: var(--bordo);
}
.auth-form { display: none; }
.auth-form.active { display: block; }
.form-group {
margin-bottom: 15px;
}
.form-group label {
display: block;
font-size: 12px;
font-weight: 600;
color: var(--text-dark);
margin-bottom: 6px;
}
.form-group input {
width: 100%;
padding: 12px;
border: 1px solid var(--border);
border-radius: 6px;
font-size: 14px;
transition: border-color 0.2s;
font-family: inherit;
}
.form-group input:focus {
outline: none;
border-color: var(--bordo);
box-shadow: 0 0 0 3px rgba(123, 30, 43, 0.1);
}
.auth-btn {
width: 100%;
padding: 12px;
background: var(--bordo);
color: white;
border: none;
border-radius: 6px;
font-weight: bold;
cursor: pointer;
font-size: 14px;
transition: all 0.2s;
margin-top: 10px;
}
.auth-btn:hover { opacity: 0.9; }
.auth-btn:disabled { opacity: 0.5; cursor: not-allowed; }
.auth-info {
font-size: 12px;
color: var(--text-light);
text-align: center;
margin-top: 15px;
}
.auth-info a {
color: var(--bordo);
text-decoration: none;
font-weight: 600;
cursor: pointer;
}
.auth-error {
background: #fadbd8;
border: 1px solid var(--danger);
color: var(--danger);
padding: 12px;
border-radius: 6px;
margin-bottom: 15px;
font-size: 13px;
display: none;
}
.auth-error.show { display: block; }
/* ===== MODAL OVERLAY ===== */
#auth-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.5);
display: none;
z-index: 2999;
backdrop-filter: blur(3px);
}
#auth-overlay.active { display: block; }
/* ===== SEPET ===== */
#cart-sidebar {
position: fixed;
right: -400px;
top: 0;
width: 340px;
height: 100%;
background: white;
z-index: 2001;
transition: right 0.3s ease-in-out;
box-shadow: -5px 0 15px rgba(0,0,0,0.15);
padding: 25px;
display: flex;
flex-direction: column;
overflow: hidden;
}
#cart-sidebar.open { right: 0; }
#overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.5);
display: none;
z-index: 2000;
backdrop-filter: blur(3px);
}
#overlay.active { display: block; }
/* ===== ÃœRÃœNLER ===== */
.content {
max-width: 1300px;
margin: 25px auto;
padding: 0 20px;
}
.grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
gap: 25px;
}
.card {
background: #fff;
border: 1px solid var(--border);
border-radius: 8px;
padding: 18px;
display: flex;
flex-direction: column;
transition: all 0.3s ease;
box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.card:hover {
transform: translateY(-5px);
box-shadow: 0 8px 20px rgba(0,0,0,0.1);
border-color: var(--bordo);
}
.product-image {
height: 140px;
background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
margin-bottom: 15px;
display: flex;
align-items: center;
justify-content: center;
color: #bdc3c7;
border-radius: 4px;
font-weight: 600;
}
.product-name {
font-weight: 600;
font-size: 15px;
min-height: 42px;
overflow: hidden;
color: var(--text-dark);
line-height: 1.4;
}
.variants-container {
margin: 12px 0;
min-height: 40px;
display: flex;
flex-wrap: wrap;
gap: 6px;
}
.v-btn {
border: 1.5px solid #ddd;
background: #fff;
padding: 6px 10px;
border-radius: 5px;
font-size: 12px;
cursor: pointer;
margin: 0;
font-weight: 600;
color: #666;
transition: all 0.2s;
white-space: nowrap;
}
.v-btn:hover {
border-color: var(--bordo);
color: var(--bordo);
}
.v-btn.selected {
border-color: var(--bordo);
color: white;
background: var(--bordo);
}
.price-display {
font-size: 24px;
font-weight: 800;
color: var(--bordo);
margin: 15px 0;
}
.buy-btn {
background: var(--bordo);
color: white;
border: none;
padding: 12px;
border-radius: 6px;
cursor: pointer;
font-weight: bold;
width: 100%;
transition: all 0.2s;
font-size: 14px;
}
.buy-btn:hover {
background: #5a1620;
transform: scale(1.02);
}
.buy-btn:disabled {
background: #bdc3c7;
cursor: not-allowed;
transform: none;
}
/* ===== NAVIGASYON ===== */
nav {
background: #fff;
border-bottom: 1px solid var(--border);
display: flex;
justify-content: center;
overflow-x: auto;
position: sticky;
top: 70px;
z-index: 999;
}
.nav-link {
padding: 15px 20px;
text-decoration: none;
color: #666;
font-size: 13px;
font-weight: 700;
cursor: pointer;
white-space: nowrap;
transition: all 0.2s;
border-bottom: 3px solid transparent;
}
.nav-link:hover {
color: var(--bordo);
border-bottom-color: var(--bordo);
}
/* ===== WHATSAPP ===== */
.wa-float {
position: fixed;
bottom: 25px;
right: 25px;
background: #25d366;
width: 60px;
height: 60px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 4px 12px rgba(0,0,0,0.2);
z-index: 1000;
text-decoration: none;
font-size: 32px;
transition: all 0.3s;
border: none;
}
.wa-float:hover {
transform: scale(1.15);
box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
}
.empty-cart {
text-align: center;
color: #999;
padding: 40px 20px;
font-size: 14px;
}
/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
header { flex-wrap: wrap; }
.search-box { max-width: 100%; margin: 10px 0 0 0; flex-basis: 100%; }
.header-right { flex-basis: 100%; margin-top: 10px; }
.grid { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); }
#cart-sidebar { width: 100%; right: -100%; }
#auth-modal { max-width: 90%; }
}
</style>
</head>
<body>
<!-- Auth Overlay -->
<div id="auth-overlay" onclick="window.closeAuth()"></div>
<!-- Auth Modal -->
<div id="auth-modal">
<button class="auth-close" onclick="window.closeAuth()">Ã—</button>
<div class="auth-tabs">
<button class="auth-tab active" onclick="window.switchAuthTab('login')">GiriÅŸ Yap</button>
<button class="auth-tab" onclick="window.switchAuthTab('signup')">KayÄ±t Ol</button>
</div>
<div id="auth-error" class="auth-error"></div>
<!-- Login Form -->
<form id="login-form" class="auth-form active" onsubmit="window.handleLogin(event)">
<div class="form-group">
<label>Email Adresi</label>
<input type="email" id="login-email" required>
</div>
<div class="form-group">
<label>Åžifre</label>
<input type="password" id="login-password" required>
</div>
<button type="submit" class="auth-btn" id="login-btn">GiriÅŸ Yap</button>
</form>
<!-- Signup Form -->
<form id="signup-form" class="auth-form" onsubmit="window.handleSignup(event)">
<div class="form-group">
<label>Ad Soyad</label>
<input type="text" id="signup-name" required>
</div>
<div class="form-group">
<label>Email Adresi</label>
<input type="email" id="signup-email" required>
</div>
<div class="form-group">
<label>Åžifre (min 6 karakter)</label>
<input type="password" id="signup-password" minlength="6" required>
</div>
<div class="form-group">
<label>Telefon</label>
<input type="tel" id="signup-phone" required>
</div>
<button type="submit" class="auth-btn" id="signup-btn">KayÄ±t Ol</button>
</form>
</div>
<!-- Cart Overlay -->
<div id="overlay" onclick="window.toggleCart(false)"></div>
<!-- Header -->
<header>
<a href="#" class="header-left" onclick="location.reload(); return false;">
<img src="logo.png" alt="AYSÄ°MA MEDÄ°KAL">
<span class="brand-name">AYSÄ°MA MEDÄ°KAL</span>
</a>
<div class="search-box">
<input type="text" placeholder="AradÄ±ÄŸÄ±nÄ±z Ã¼rÃ¼nÃ¼ yazÄ±n..." onkeyup="window.doSearch(this.value)">
<button onclick="window.doSearch(document.querySelector('.search-box input').value)">ARA</button>
</div>
<div class="header-right">
<div class="user-menu">
<button class="user-btn" id="user-btn" onclick="window.toggleUserMenu()">
ðŸ‘¤ <span id="user-display">GiriÅŸ Yap</span>
</button>
<div id="user-dropdown" class="user-dropdown">
<a href="#" onclick="window.goToProfile()">Profilim</a>
<a href="#" onclick="window.goToOrders()">SipariÅŸlerim</a>
<a href="#" onclick="window.goToAddresses()">Adreslerim</a>
<button onclick="window.logout()" class="logout">Ã‡Ä±kÄ±ÅŸ Yap</button>
</div>
</div>
<button class="cart-btn" onclick="window.toggleCart(true)">
ðŸ›’ Sepet <span id="cart-count">0</span>
</button>
</div>
</header>
<!-- Navigation -->
<nav id="navbar">
<a class="nav-link" onclick="location.reload(); return false;">TÃœM ÃœRÃœNLER</a>
</nav>
<!-- Content -->
<div class="content">
<h2 id="page-name" style="font-size: 22px; margin-bottom: 25px; color: var(--text-dark);">TÃ¼m ÃœrÃ¼nler</h2>
<div class="grid" id="product-grid">ÃœrÃ¼nler yÃ¼kleniyor...</div>
</div>
<!-- WhatsApp -->
<a href="https://wa.me/905000000000" class="wa-float" target="_blank" title="WhatsApp'tan iletiÅŸime geÃ§">ðŸ’¬</a>
<!-- Cart Sidebar -->
<div id="cart-sidebar">
<div style="display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid #f4f4f4; padding-bottom:15px; margin-bottom:15px;">
<h3 style="margin:0; font-size:18px;">Sepetim</h3>
<button style="font-size:28px; cursor:pointer; background:none; border:none; color:#999; transition:0.2s;"
onclick="window.toggleCart(false)" title="Sepeti kapat">Ã—</button>
</div>
<div id="cart-items" style="flex-grow:1; overflow-y:auto; padding:0;"></div>
<div style="border-top:2px solid #eee; padding-top:20px;">
<div style="display:flex; justify-content:space-between; font-size:18px; font-weight:800; color:var(--bordo); margin-bottom:20px;">
<span>Toplam:</span>
<span><span id="cart-total">0.00</span> â‚º</span>
</div>
<button id="checkout-btn" style="width:100%; background:var(--success); color:white; border:none; padding:15px; border-radius:6px; font-weight:bold; cursor:pointer; font-size:16px; transition:0.2s;"
onclick="window.handleCheckout()" disabled>SipariÅŸi Tamamla</button>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseUrl = "https://eqpioawtdwkaeuxpfspt.supabase.co";
const supabaseKey = "sb_publishable_j1qHO04E6qvGJxoQksdHlA_p89plyCA";
const _supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
let currentUser = null;
let masterData = [];
let cart = JSON.parse(localStorage.getItem('aysima_cart')) || [];
// ===== AUTH FUNCTIONS =====
window.openAuth = () => {
document.getElementById('auth-modal').classList.add('active');
document.getElementById('auth-overlay').classList.add('active');
};
window.closeAuth = () => {
document.getElementById('auth-modal').classList.remove('active');
document.getElementById('auth-overlay').classList.remove('active');
window.clearAuthErrors();
};
window.switchAuthTab = (tab) => {
document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
event.target.classList.add('active');
document.getElementById(tab + '-form').classList.add('active');
window.clearAuthErrors();
};
window.showAuthError = (message) => {
const errorDiv = document.getElementById('auth-error');
errorDiv.textContent = message;
errorDiv.classList.add('show');
};
window.clearAuthErrors = () => {
document.getElementById('auth-error').classList.remove('show');
};
window.handleLogin = async (e) => {
e.preventDefault();
window.clearAuthErrors();
const email = document.getElementById('login-email').value;
const password = document.getElementById('login-password').value;
const btn = document.getElementById('login-btn');
btn.disabled = true;
btn.textContent = 'GiriÅŸ yapÄ±lÄ±yor...';
try {
const { data, error } = await _supabase.auth.signInWithPassword({ email, password });
if(error) {
window.showAuthError('Email veya ÅŸifre hatalÄ±!');
btn.disabled = false;
btn.textContent = 'GiriÅŸ Yap';
return;
}
currentUser = data.user;
localStorage.setItem('aysima_user', JSON.stringify(currentUser));
window.updateUserUI();
window.closeAuth();
alert('HoÅŸ geldiniz!');
} catch(e) {
console.error('Login hatasÄ±:', e);
window.showAuthError('Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');
} finally {
btn.disabled = false;
btn.textContent = 'GiriÅŸ Yap';
}
};
window.handleSignup = async (e) => {
e.preventDefault();
window.clearAuthErrors();
const name = document.getElementById('signup-name').value;
const email = document.getElementById('signup-email').value;
const password = document.getElementById('signup-password').value;
const phone = document.getElementById('signup-phone').value;
const btn = document.getElementById('signup-btn');
btn.disabled = true;
btn.textContent = 'KayÄ±t yapÄ±lÄ±yor...';
try {
const { data: signupData, error: signupError } = await _supabase.auth.signUp({
email,
password,
options: {
data: { full_name: name, phone: phone }
}
});
if(signupError) {
window.showAuthError(signupError.message);
btn.disabled = false;
btn.textContent = 'KayÄ±t Ol';
return;
}
// User profilini users tablosuna ekle
const { error: profileError } = await _supabase.from('users').insert([{
id: signupData.user.id,
email: email,
full_name: name,
phone: phone
}]);
if(profileError) throw profileError;
currentUser = signupData.user;
localStorage.setItem('aysima_user', JSON.stringify(currentUser));
window.updateUserUI();
window.closeAuth();
alert('KayÄ±t baÅŸarÄ±lÄ±! HoÅŸ geldiniz.');
} catch(e) {
console.error('Signup hatasÄ±:', e);
window.showAuthError('KayÄ±t baÅŸarÄ±sÄ±z. Bu email zaten kullanÄ±lÄ±yor olabilir.');
} finally {
btn.disabled = false;
btn.textContent = 'KayÄ±t Ol';
}
};
window.toggleUserMenu = () => {
document.getElementById('user-dropdown').classList.toggle('active');
};
window.logout = () => {
if(confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinize emin misiniz?')) {
currentUser = null;
localStorage.removeItem('aysima_user');
_supabase.auth.signOut();
window.updateUserUI();
document.getElementById('user-dropdown').classList.remove('active');
location.reload();
}
};
window.updateUserUI = () => {
const userDisplay = document.getElementById('user-display');
const userBtn = document.getElementById('user-btn');
if(currentUser) {
const email = currentUser.email.split('@')[0];
userDisplay.textContent = email;
userBtn.style.borderColor = 'var(--success)';
userBtn.style.color = 'var(--success)';
} else {
userDisplay.textContent = 'GiriÅŸ Yap';
userBtn.style.borderColor = 'var(--bordo)';
userBtn.style.color = 'var(--bordo)';
}
};
window.goToProfile = () => {
if(!currentUser) {
window.openAuth();
return;
}
alert('Profil sayfasÄ± hazÄ±rlanÄ±yor...');
document.getElementById('user-dropdown').classList.remove('active');
};
window.goToOrders = () => {
if(!currentUser) {
window.openAuth();
return;
}
alert('SipariÅŸlerim sayfasÄ± hazÄ±rlanÄ±yor...');
document.getElementById('user-dropdown').classList.remove('active');
};
window.goToAddresses = () => {
if(!currentUser) {
window.openAuth();
return;
}
alert('Adreslerim sayfasÄ± hazÄ±rlanÄ±yor...');
document.getElementById('user-dropdown').classList.remove('active');
};
// ===== CART FUNCTIONS =====
window.toggleCart = (show) => {
document.getElementById('cart-sidebar').classList.toggle('open', show);
document.getElementById('overlay').classList.toggle('active', show);
};
window.updateCard = (btn, price, vid, vname, stock) => {
const card = btn.closest('.card');
card.querySelectorAll('.v-btn').forEach(b => b.classList.remove('selected'));
btn.classList.add('selected');
card.querySelector('.price-display').textContent = price + ' â‚º';
const buyBtn = card.querySelector('.buy-btn');
buyBtn.setAttribute('data-v-id', vid);
buyBtn.setAttribute('data-v-price', price);
buyBtn.setAttribute('data-v-name', vname);
if(stock <= 0) {
buyBtn.disabled = true;
buyBtn.textContent = 'TÃœKENDÄ°';
} else {
buyBtn.disabled = false;
buyBtn.textContent = 'SEPETE EKLE';
}
};
window.addToCart = (pid, pname, btn) => {
const vid = btn.getAttribute('data-v-id');
const vprice = parseFloat(btn.getAttribute('data-v-price'));
const vname = btn.getAttribute('data-v-name');
if (!vid || vid === 'null') {
alert('LÃ¼tfen bir varyant seÃ§in.');
return;
}
const existing = cart.find(i => i.vid === vid && i.pid === pid);
if (existing) {
existing.qty++;
} else {
cart.push({ pid, pname, vid, vname, vprice, qty: 1 });
}
localStorage.setItem('aysima_cart', JSON.stringify(cart));
window.updateCartUI();
window.toggleCart(true);
};
window.updateCartUI = () => {
const itemsDiv = document.getElementById('cart-items');
let total = 0, count = 0;
if(cart.length === 0) {
itemsDiv.innerHTML = '<div class="empty-cart">Sepetiniz boÅŸ</div>';
document.getElementById('checkout-btn').disabled = true;
document.getElementById('cart-count').textContent = '0';
return;
}
itemsDiv.innerHTML = '';
cart.forEach((item, idx) => {
total += item.vprice * item.qty;
count += item.qty;
itemsDiv.innerHTML += `
`;
});
document.getElementById('cart-total').textContent = total.toFixed(2);
document.getElementById('cart-count').textContent = count;
document.getElementById('checkout-btn').disabled = false;
};
window.remove = (i) => {
cart.splice(i, 1);
localStorage.setItem('aysima_cart', JSON.stringify(cart));
window.updateCartUI();
};
window.doSearch = (t) => {
if(t.trim() === '') {
renderProducts(masterData);
} else {
renderProducts(masterData.filter(p => p.name.toLowerCase().includes(t.toLowerCase())));
}
};
window.handleCheckout = () => {
if(!currentUser) {
alert('LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n!');
window.openAuth();
return;
}
if(cart.length === 0) {
alert('Sepetiniz boÅŸ!');
return;
}
// TODO: Ã–deme sayfasÄ±na yÃ¶nlendir
alert('Ã–deme sistemi kÄ±sa sÃ¼rede aktif olacak!');
};
// ===== PRODUCT FUNCTIONS =====
async function init() {
try {
// KaydedilmiÅŸ kullanÄ±cÄ± varsa yÃ¼kle
const saved = localStorage.getItem('aysima_user');
if(saved) {
currentUser = JSON.parse(saved);
// TODO: KullanÄ±cÄ± hala valid mi kontrol et
}
window.updateUserUI();
window.updateCartUI();
const { data: cats, error } = await _supabase.from('categories').select('*');
if(error) {
console.error('Kategori yÃ¼kleme hatasÄ±:', error);
document.getElementById('product-grid').innerHTML = 'ÃœrÃ¼nler yÃ¼klenemedi.';
return;
}
cats?.forEach(c => {
const a = document.createElement('a');
a.className = 'nav-link';
a.textContent = c.name.toUpperCase();
a.onclick = () => fetchProducts(c.id, c.name);
document.getElementById('navbar').appendChild(a);
});
fetchProducts();
} catch(e) {
console.error('BaÅŸlatma hatasÄ±:', e);
}
}
async function fetchProducts(cid = null, cname = 'TÃ¼m ÃœrÃ¼nler') {
try {
document.getElementById('page-name').textContent = cname;
const grid = document.getElementById('product-grid');
grid.innerHTML = 'ÃœrÃ¼nler hazÄ±rlanÄ±yor...';
let q = _supabase.from('products').select('*, product_variants(*)').eq('is_active', true);
if(cid) q = q.eq('category_id', cid);
const { data, error } = await q;
if(error) throw error;
masterData = data || [];
renderProducts(masterData);
} catch(e) {
console.error('ÃœrÃ¼n yÃ¼kleme hatasÄ±:', e);
document.getElementById('product-grid').innerHTML = 'ÃœrÃ¼nler yÃ¼klenemedi.';
}
}
function renderProducts(list) {
const container = document.getElementById('product-grid');
if(list.length === 0) {
container.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:40px; color:#999;">ÃœrÃ¼n bulunamadÄ±.</div>';
return;
}
container.innerHTML = '';
list.forEach(p => {
const vars = p.product_variants.filter(v => v.is_active);
const def = vars[0] || { price: 0, variant_value: '-', id: 'null', stock: 0 };
const card = document.createElement('div');
card.className = 'card';
card.innerHTML = `
`;
container.appendChild(card);
});
}
function escapeHtml(text) {
const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
return text.replace(/[&<>"']/g, m => map[m]);
}
// Close dropdown when clicking outside
document.addEventListener('click', (e) => {
if(!e.target.closest('.user-menu')) {
document.getElementById('user-dropdown').classList.remove('active');
}
});
init();
</script>
</body>
</html>
